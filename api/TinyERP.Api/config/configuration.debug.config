<?xml version="1.0" encoding="utf-8" ?>
<appconfiguration>
  <schedulers>
    <add name="TINYERP_SCHEDULER_SERVICE" fetchUri="http://api.tinyerp.com/api/scheduler/jobs/fetch"></add>
  </schedulers>
  <endpoints>
    <add name="EMAIL_SCHEDULER_RECEIVER" type="REST" uri="http://api.tinyerp.com/api/scheduler/jobs">
      <authorization type="Basic" userName="user" password="pwd"></authorization>
    </add>
  </endpoints>
  <settings
    baseUri="http://api.tinyerp.com"
    clientUri="http://tinyerp.com"
    defaultLanguageIsoCode="en"
    >
  </settings>
  <appSettings>
    <add name="AppSetting.Folder.Export" value="{{Configuration!!Folder.BaseResourceFolder}}\export"/>
    <add name="Data.Migration.Autorun" value="true"></add>
  </appSettings>
  <securitySettings>
    <add name="Data.Migration.Autorun" value="true"></add>
    <add name="account.activationLink" value="/learning/learning/account/activate/{{ActivationCode}}"></add>
  </securitySettings>
  <authentication allowOrigins="*" basePath="http://api.tinyerp.com/" path="/auth/token" tokenExpiredAfterInMinute="20" authType="OwinTokenBase" ></authentication>
  <paging pageSize="10"></paging>
  <repository defaultRepoType="MSSQL" defaultConnectionStringName="DefaultConnection"></repository>
  <search defaultUrl="http://localhost:9200"></search>
  <modules>
    <add name="App.Security" integrationType="InApp"></add>
  </modules>
  <aggregates>
    <add name="App.Scheduler.Share.Context.ISchedulerDbContext" repoType="MSSQL" connectionStringName="TinyERP_SingleDbContext"></add>
    
    <add name="App.Setting.Shared.Context.ISettingQueryDbContext" repoType="MongoDb" connectionStringName="DefaultMongoDb"></add>
    <add name="App.Setting.Shared.Context.ISettingDbContext" repoType="MSSQL" connectionStringName="TinyERP_SingleDbContext"></add>
    
    <add name="App.Common.Support.Shared.Context.ISupportQueryDbContext" repoType="MongoDb" connectionStringName="DefaultMongoDb"></add>
    <add name="App.Common.Support.Shared.Context.ISupportDbContext" repoType="MSSQL"  connectionStringName="TinyERP_SingleDbContext"></add>

    <add name="App.Security.Share.Context.ISecurityDbContext" repoType="MSSQL"  connectionStringName="TinyERP_SingleDbContext"></add>
    <add name="App.Security.Share.Context.ISecurityQueryDbContext" repoType="MongoDb" connectionStringName="DefaultMongoDb"></add>

    <add name="App.Media.Share.Context.IMediaDbContext" repoType="MSSQL" connectionStringName="TinyERP_SingleDbContext"></add>
    <add name="App.Media.Share.Context.IMediaQueryDbContext" repoType="MongoDb" connectionStringName="DefaultMongoDb"></add>

    <add name="App.Learning.Share.Context.ILearningDbContext" repoType="MSSQL" connectionStringName="TinyERP_SingleDbContext"></add>
    <add name="App.Learning.Share.Context.ILearningQueryDbContext" repoType="MongoDb" connectionStringName="DefaultMongoDb"></add>

    <add name="App.Common.IDefaultDbContext" repoType="MSSQL" connectionStringName="TinyERP_SingleDbContext"></add>

    <add name="App.MessageBus.Share.Context.IMessageBusDbContext" repoType="MSSQL" connectionStringName="TinyERP_DefaultMessageBus"></add>

    <!--<add name="App.Media.Aggregate.MediaAggregate" repoType="MSSQL" connectionStringName="MediaConnection"></add>-->
    <!--<add name="App.Learning.Aggregate.CourseAggregate" repoType="MSSQL" connectionStringName="LearningConnection"></add>-->
    <!--<add name="App.Order.Aggregate.OrderAggregate" repoType="MSSQL" connectionStringName="OrderConnection"></add>-->
    <!--<add name="App.Security.Aggregate.User" repoType="MSSQL" connectionStringName="SecurityConnection"></add>-->
    <!--<add name="App.MessageBus.Aggregate.BusEventAggregate" repoType="MSSQL" connectionStringName="DefaultMessageBus"></add>-->
  </aggregates>
  <commandHandlerSettings>
    <!-- InApp, External-->
    <add aggregate="App.Order.Aggregate.OrderAggregate" type="InApp"></add>
  </commandHandlerSettings>
  <!-- InApp, External-->
  <eventHandlers>
    <add eventName="App.Order.Event.OnOrderCreated" type="External"></add>
    <add eventName="App.Order.Event.OnOrderLineItemAdded" type="External"></add>
    <add eventName="App.Order.Event.OnCustomerDetailChanged" type="External"></add>
  </eventHandlers>
  <messageBus
    baseUri="http://messagebus.tinyerp.com:80"
  ></messageBus>
  <databases>
    <clear />

    <add
      name="TinyERP_LearningContext"
      database="AppSetting!!LEARNING_MSSQL_DATABASE_NAME"
      server="AppSetting!!LEARNING_MSSQL_SERVER"
      port="AppSetting!!LEARNING_MSSQL_PORT"
      userName="AppSetting!!LEARNING_MSSQL_USER_NAME"
      password="AppSetting!!LEARNING_MSSQL_PASSWORD"
      dbType="MSSQL"
    ></add>
    <add
      name="TinyERP_LearningMongoDb"
      database="AppSetting!!LEARNING_MONGODB_DATABASE_NAME"
      server="AppSetting!!LEARNING_MONGODB_SERVER"
      port="AppSetting!!LEARNING_MONGODB_PORT"
      userName="AppSetting!!LEARNING_MONGODB_USER_NAME"
      password="AppSetting!!LEARNING_MONGODB_PASSWORD"
      ssl="AppSetting!!LEARNING_MONGODB_SSL"
      dbType="MongoDb"
    ></add>
    <!--<add name="DefaultConnection" database="MyERP" server="PC\SQLEXPRESS" port="1433" userName="sa" password="1qazxsw2" dbType="MSSQL" default="true"></add>-->

    <add name="TinyERP_SingleDbContext" database="AppSetting!!MSSQL_DATABASE_NAME" server="AppSetting!!MSSQL_SERVER" port="AppSetting!!MSSQL_PORT" userName="AppSetting!!MSSQL_USER_NAME" password="AppSetting!!MSSQL_PASSWORD" dbType="MSSQL" default="true"></add>
    <!--<add name="TinyERP_SingleDbContext" database="db20ce03542744488cba93a4c0002d18d8" server="20ce0354-2744-488c-ba93-a4c0002d18d8.sqlserver.sequelizer.com" port="1433" userName="ohzgbufuvbvlqvnm" password="8JZWd3857rzLdQ8paSb4cgChMJ6mvQWSa7JH7kLNr8sUxHTjeHz4YJzZfRiA5UHp" dbType="MSSQL" default="true"></add>-->

    <!--<add name="TinyERP_DefaultConnection" database="MyERP_DefaultDb" server=".\SQLEXPRESS" port="1433" userName="sa" password="123456" dbType="MSSQL" default="true"></add>
    <add name="TinyERP_SupportConnection" database="MyERP_Support" server=".\SQLEXPRESS" port="1433" userName="sa" password="123456" dbType="MSSQL" default="true"></add>

    
    <add name="MediaConnection" database="MyERP_Media" server=".\SQLEXPRESS" port="0" userName="sa" password="123456" dbType="MSSQL" default="true"></add>
    <add name="LearningConnection" database="MyERP_Learning" server=".\SQLEXPRESS" port="0" userName="sa" password="123456" dbType="MSSQL" default="true"></add>
    <add name="SecurityConnection" database="MyERP_Security" server=".\SQLEXPRESS" port="1433" userName="sa" password="123456" dbType="MSSQL" default="true"></add>
    <add name="TinyERP_DefaultMessageBus" database="MyERP_MessageBus" server=".\SQLEXPRESS" port="1433" userName="sa" password="123456" dbType="MSSQL" default="true"></add> -->
    <!--<add name="DefaultMongoDb" database="MyERP" server="localhost" port="27017" userName="" password="" dbType="MongoDb" default="true"></add>-->
    <add 
      name="DefaultMongoDb" 
      database="AppSetting!!MONGODB_DATABASE_NAME" 
      server="AppSetting!!MONGODB_SERVER" 
      port="AppSetting!!MONGODB_PORT" 
      userName="AppSetting!!MONGODB_USER_NAME" 
      password="AppSetting!!MONGODB_PASSWORD" 
      ssl="AppSetting!!MONGODB_SSL" 
      dbType="MongoDb" 
      default="true"
    ></add>
  </databases>
  <localization defaultLanguageCode="en"></localization>
  <mail providerType="Mailgun" server="smtp.gmail.com" port="587" ssl="true" username="tinyerp123456@gmail.com" password="!QAZxsw2#" displayName="No-reply" defaultSender="tinyerp123456@gmail.com" />
  
  <!--<mailgun apiKey="ccbb7090df197a55de55318a83d3ec3b-3b1f59cf-d2bd5572" baseUri="https://api.mailgun.net/v3/sandbox7aea6f4f01ef49958d3a1e2576f59fc6.mailgun.org"></mailgun>-->
  <mailgun apiKey="AppSetting!!MAIL_GUN_APIKEY" baseUri="AppSetting!!MAIL_GUN_URI"></mailgun>
  
  <folder mailTemplate="templates/email/" rootFolder="" baseResourceFolder="{{Configuration!!Folder.RootFolder}}\Resources\"></folder>
  <integration-test baseUrl="http://api.tinyerp.com/api" outputFolder="D:\project\tfs_tinyerp\test\integration_test" extension=".txt"></integration-test>
  <uitest reportTemplate="templates/report.xlsx" notificationReceiver="thanhtuit27@gmail.com" zipFile="report_{0}.zip" environtmenFile="environments.xml" basePath="C:\data\projects\myERP\api\App.UI.Test\config\" baseOutput="C:\data\projects\myERP\api\App.UI.Test\output\" timeout="10"></uitest>
</appconfiguration>
